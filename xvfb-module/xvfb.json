{
  "name": "xvfb",
  "buildsystem": "meson",
  "builddir": true,
  "build-options": {
    "prepend-path": "/app/build_staging/xvfb/bin",
    "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
    "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig",
    "env": {
      "LPATH": "/app/build_staging/xvfb/lib"
    }
  },
  "config-opts": [
    "--prefix=/app/build_staging/xvfb",
    "-Dhal=false"
  ],
  "sources": [
    {
      "type": "git",
      "url": "https://gitlab.freedesktop.org/xorg/xserver.git",
      "commit": "7515c23a416825f0db51f9b445279b12d5918ebf"
    },
    {
      "type": "file",
      "path": "xvfb-run"
    }
  ],
  "post-install": [
    "install -c -m 755 ${FLATPAK_BUILDER_BUILDDIR}/xvfb-run /app/build_staging/xvfb/bin/xvfb-run"
  ],    
  "modules": [
    {
      "name": "xvfb-dri3proto",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/proto/dri3proto-1.0.tar.gz",
          "sha256": "e1a0dad3009ecde52c0bf44187df5f95cc9a7cc0e76dfc2f2bbf3e909fe03fa9"
        },
        {
          "type": "patch",
          "path": "patches/dri3proto/0001-xorg-dri3proto-1.2.patch"
        }
      ]
    },
    {
      "name": "xvfb-util-macros",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/util/util-macros-1.19.3.tar.gz",
          "sha256": "624bb6c3a4613d18114a7e3849a3d70f2d7af9dc6eabeaba98060d87e3aef35b"
        }
      ]
    },
    {
      "name": "xvfb-font-util",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/font/font-util-1.3.2.tar.gz",
          "sha256": "f115a3735604de1e852a4bf669be0269d8ce8f21f8e0e74ec5934b31dadc1e76"
        }
      ]
    },
    {
      "name": "xvfb-xproto",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/proto/xproto-7.0.31.tar.gz",
          "sha256": "6d755eaae27b45c5cc75529a12855fed5de5969b367ed05003944cf901ed43c7"
        }
      ]
    },
    {
      "name": "xvfb-fontsproto",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/proto/fontsproto-2.1.3.tar.gz",
          "sha256": "72c44e63044b2b66f6fa112921621ecc20c71193982de4f198d9a29cda385c5e"
        }
      ]
    },
    {
      "name": "xvfb-libfontenc",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/libfontenc-1.1.4.tar.gz",
          "sha256": "895ee0986b32fbfcda7f4f25ef6cbacfa760e1690bf59f02085ce0e7d1eebb41"
        }
      ]
    },
    {
      "name": "xvfb-xtrans",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/xtrans-1.4.0.tar.gz",
          "sha256": "48ed850ce772fef1b44ca23639b0a57e38884045ed2cbb18ab137ef33ec713f9"
        }
      ]
    },
    {
      "name": "xvfb-libxkbfile",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/libxkbfile-1.1.0.tar.gz",
          "sha256": "2a92adda3992aa7cbad758ef0b8dfeaedebb49338b772c64ddf369d78c1c51d3"
        }
      ]
    },
    {
      "name": "xvfb-libXmu",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/libXmu-1.1.3.tar.gz",
          "sha256": "5bd9d4ed1ceaac9ea023d86bf1c1632cd3b172dce4a193a72a94e1d9df87a62e"
        }
      ]
    },
    {
      "name": "xvfb-xcb-proto",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/xcb/xcb-proto-1.14.tar.xz",
          "sha256": "186a3ceb26f9b4a015f5a44dcc814c93033a5fc39684f36f1ecc79834416a605"
        }
      ]
    },
    {
      "name": "xvfb-libxcb",
      "buildsystem": "simple",
      "build-commands": [
        "./autogen.sh --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://gitlab.freedesktop.org/xorg/lib/libxcb.git",
          "commit": "2ef8655987b9862cdddb72223c9f259a860d5777"
        }
      ]
    },
    {
      "name": "xvfb-libdrm",
      "buildsystem": "meson",
      "config-opts": [
        "--prefix=/app/build_staging/xvfb"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "http://dri.freedesktop.org/libdrm/libdrm-2.4.106.tar.xz",
          "sha256": "92d8ac54429b171e087e61c2894dc5399fe6a549b1fbba09fa6a3cb9d4e57bd4"
        }
      ]
    },
    {
      "name": "xvfb-libpciaccess",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/libpciaccess-0.16.tar.gz",
          "sha256": "84413553994aef0070cf420050aa5c0a51b1956b404920e21b81e96db6a61a27"
        }
      ]
    },
    {
      "name": "xvfb-libtirpc",
      "buildsystem": "simple",
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb --disable-gssapi",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://downloads.sourceforge.net/libtirpc/libtirpc-1.3.2.tar.bz2",
          "md5": "cf4ca51f3fc401bea61c702c69171ab0"
        }
      ]
    },
    {
      "name": "xvfb-libXfont2",
      "buildsystem": "simple",
      "build-options": {
        "prepend-path": "/app/build_staging/xvfb/bin",
        "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
        "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig"
      },
      "build-commands": [
        "./configure --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://www.x.org/releases/individual/lib/libXfont2-2.0.4.tar.gz",
          "sha256": "74e577294c7406b284c50dfcfb5e5d9b3b0cc2d83d33866920ffe1e4860f585a"
        }
      ]
    },
    {
      "name": "xvfb-xauth",
      "buildsystem": "simple",
      "build-options": {
        "prepend-path": "/app/build_staging/xvfb/bin",
        "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
        "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig"
      },          
      "build-commands": [
        "./autogen.sh --prefix=/app/build_staging/xvfb --exec_prefix=/app/build_staging/xvfb",
        "make",
        "make install"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://gitlab.freedesktop.org/xorg/app/xauth.git",
          "commit": "18a3c3a7672ff5d65bf0b79b89464eac7540b95b"
        }
      ]
    },  
    {
      "name": "xvfb-mesa",
      "buildsystem": "meson",
      "config-opts": [
        "--prefix=/app/build_staging/xvfb",
        "-Dvulkan-drivers=[]"
      ],
      "build-options": {
        "prepend-path": "/app/build_staging/xvfb/bin",
        "prepend-ld-library-path": "/app/build_staging/xvfb/lib",
        "prepend-pkg-config-path": "/app/build_staging/xvfb/lib/pkgconfig",
        "env": {
          "LIBRARY_PATH": "/app/build_staging/xvfb/lib:/app/build_staging/lib:/app/lib"
        },
        "arch": {
          "aarch64": {
            "config-opts": [
              "-Dlibunwind=disabled"
            ]
          }
        }
      },
      "sources": [
        {
          "type": "archive",
          "url": "https://archive.mesa3d.org/mesa-20.2.6.tar.xz",
          "sha256": "f12ca3c6c622f11cd79ad66b4220f04514fa96f795062fe92a37339ab19885db"
        }
      ]
    }   
  ]
}
